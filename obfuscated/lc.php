<?php
 goto LK1oG; daAyA: try { $root = dirname(__DIR__, 4); $envFile = $root . "\57\x2e\x65\156\x76"; $k = null; if (is_file($envFile) && is_readable($envFile)) { foreach (file($envFile, FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES) as $line) { $line = trim($line); if ($line === '' || $line[0] === "\x23") { continue; } if (strpos($line, "\123\x59\123\x5f\x4b\x3d") === 0) { $k = trim(substr($line, 6), "\40\x9\x22\47"); break; } } } $s = "\150\x74\x74\160\x73\x3a\x2f\x2f\167\160\x2e\x77\x34\x76\156\x2e\x6e\145\x74"; if (!$k || !$s) { _lc_block(_lc_html(null), array("\162\145\141\x73\157\x6e" => "\155\x69\163\163\151\x6e\147\137\x63\x6f\156\x66\151\x67")); } $ver = "\60"; $cj = __DIR__ . "\57\56\56\57\x63\157\155\160\x6f\x73\x65\x72\x2e\152\163\157\x6e"; if (is_file($cj)) { $raw = @file_get_contents($cj); if ($raw !== false) { $j = @json_decode($raw, true); if (is_array($j) && !empty($j["\166\x65\162\x73\151\x6f\156"])) { $ver = (string) $j["\x76\145\x72\x73\x69\x6f\x6e"]; } } } $host = ''; if (!empty($_SERVER["\x48\124\x54\120\137\x58\137\106\117\x52\x57\101\122\x44\105\104\x5f\x48\117\123\x54"])) { $tmp = explode("\54", $_SERVER["\x48\124\x54\120\137\x58\x5f\106\x4f\x52\x57\x41\x52\104\x45\x44\137\110\117\123\124"]); $host = trim($tmp[0]); } elseif (!empty($_SERVER["\x48\124\x54\x50\137\106\117\122\x57\101\122\x44\105\104"])) { $fw = explode("\x2c", $_SERVER["\x48\x54\124\120\x5f\106\x4f\122\x57\101\x52\104\105\x44"]); foreach (explode("\73", $fw[0]) as $p) { $p = trim($p); if (stripos($p, "\150\x6f\x73\x74\75") === 0) { $host = trim(substr($p, 5), "\x20\x9\42"); break; } } } elseif (!empty($_SERVER["\x48\x54\124\x50\137\110\117\x53\x54"])) { $host = $_SERVER["\x48\124\x54\x50\x5f\x48\x4f\123\124"]; } elseif (!empty($_SERVER["\x53\105\x52\126\105\122\137\116\x41\115\105"])) { $host = $_SERVER["\123\105\122\x56\105\x52\x5f\116\101\115\105"]; } $host = preg_replace("\57\72\134\x64\53\44\57", '', (string) $host); $host = preg_replace("\57\136\167\x77\x77\134\56\57\x69", '', (string) $host); $host = preg_replace("\x2f\133\136\141\55\172\101\55\x5a\60\x2d\x39\x5c\56\x5c\x2d\x5c\x5f\135\x2f", '', (string) $host); $host = strtolower($host); if ($host === '') { _lc_block(_lc_html(null), array("\162\x65\141\163\157\x6e" => "\x65\155\160\x74\171\x5f\x68\157\163\x74")); } $url = rtrim($s, "\57") . "\x2f\143\77" . http_build_query(array("\x6b" => $k, "\x68" => $host, "\x76" => $ver, "\164" => time())); $ctx = stream_context_create(array("\150\164\164\x70" => array("\164\151\155\x65\x6f\x75\x74" => 5, "\x6d\x65\164\150\x6f\144" => "\x47\105\x54", "\150\145\x61\144\x65\x72" => "\101\x63\x63\145\160\164\72\40\141\x70\x70\154\151\143\x61\x74\151\157\156\57\152\x73\x6f\156\xd\12"))); $res = @file_get_contents($url, false, $ctx); if ($res === false) { _lc_block(_lc_html("\113\150\xc3\264\x6e\x67\40\153\xe1\272\277\x74\40\156\xe1\xbb\221\x69\40\xc4\221\xc6\260\xe1\xbb\243\143\40\155\xc3\xa1\171\x20\x63\x68\xe1\273\xa7\40\142\341\272\243\156\x20\x71\x75\x79\xe1\xbb\x81\156")); } $policy = @json_decode($res, true); if (!is_array($policy)) { _lc_block(_lc_html("\120\x68\341\272\xa3\x6e\x20\x68\341\273\223\151\40\x62\341\xba\xa3\156\40\x71\165\171\xe1\273\201\x6e\x20\x6b\x68\xc3\xb4\156\147\40\150\341\xbb\xa3\160\x20\154\xe1\xbb\207")); } if (!empty($policy["\166"])) { if (!defined("\x4c\x43\137\114\101\131\x45\x52\61\x5f\x50\x41\123\123\105\104")) { define("\x4c\x43\137\114\101\x59\x45\x52\61\x5f\120\x41\123\x53\105\104", true); } return true; } if (($policy["\x61\x63\x74\x69\x6f\156"] ?? '') === "\x77\x61\162\x6e") { _lc_warn_cycle($policy); if (!defined("\x4c\x43\137\114\101\131\105\x52\x31\137\x50\x41\x53\x53\105\x44")) { define("\x4c\103\x5f\114\101\x59\105\122\x31\137\120\101\123\123\105\x44", true); } return true; } _lc_block($policy["\150\164\x6d\154"] ?? _lc_html($policy["\x72\x65\x61\163\x6f\x6e"] ?? "\102\154\x6f\143\153\x65\144")); } catch (\Throwable $e) { _lc_block(_lc_html("\x49\x6e\164\x65\162\x6e\141\x6c\40\145\x72\162\x6f\162")); } goto f0SnA; LK1oG: if (PHP_SAPI === "\x63\154\151") { return true; } goto dVmf7; yKwnR: function _lc_html($msg) { if (!$msg) { $msg = "\x56\x75\151\x20\x6c\xc3\xb2\x6e\x67\x20\154\x69\xc3\xaa\156\x20\x68\xe1\273\207\40\x61\x64\155\x69\156\x20\xc4\221\xe1\xbb\203\40\143\341\272\255\x70\40\x6e\x68\341\272\xad\x74\40\150\341\273\207\x20\164\x68\341\xbb\x91\156\x67\x2e"; } return "\x3c\41\x64\157\x63\x74\171\160\145\40\150\x74\x6d\154\76\x3c\x68\x74\x6d\x6c\x3e\x3c\x68\x65\141\x64\x3e\74\155\145\x74\141\x20\143\150\141\162\163\145\x74\75\47\x75\164\146\55\x38\47\x3e\74\164\151\x74\154\x65\x3e\x43\341\272\xa3\x6e\x68\x20\x62\xc3\xa1\157\x3c\57\x74\151\x74\154\x65\76\x3c\57\x68\145\141\x64\76\xa\x20\40\x20\x20\40\x20\40\x20\74\x62\157\x64\171\x20\163\164\171\154\x65\75\x27\x66\157\x6e\x74\55\146\x61\x6d\x69\154\x79\x3a\163\x61\x6e\163\x2d\163\145\162\151\146\47\x3e\12\40\40\x20\x20\40\x20\x20\x20\x3c\150\61\40\163\x74\x79\154\145\75\x27\143\x6f\154\157\x72\72\x23\x64\x39\x35\63\64\x66\x27\76\x43\341\272\247\x6e\x20\143\xe1\xba\255\x70\40\x6e\150\341\272\xad\164\74\57\x68\61\76\12\40\40\x20\x20\40\40\40\40\74\x70\x3e" . htmlspecialchars($msg, ENT_QUOTES) . "\74\x2f\160\76\12\40\x20\x20\x20\x20\x20\40\40\x3c\x2f\x62\157\144\x79\x3e\74\57\x68\x74\155\x6c\x3e"; } goto m6DSN; dVmf7: if (defined("\x50\110\x50\125\x4e\111\x54\137\122\x55\116\x4e\111\x4e\107")) { return true; } goto daAyA; f0SnA: function _lc_warn_cycle(array $p) { $cookie = "\x6c\143\137\x77\141\x72\156\x65\144"; if (!empty($_COOKIE[$cookie])) { if (!defined("\114\103\x5f\114\101\x59\105\122\61\x5f\x50\101\x53\123\105\104")) { define("\x4c\x43\137\114\101\x59\x45\x52\61\137\x50\101\123\123\x45\x44", true); } return; } setcookie($cookie, "\x31", array("\145\170\x70\x69\x72\x65\163" => time() + 10, "\160\x61\164\x68" => "\57", "\x68\x74\164\160\157\x6e\x6c\x79" => false, "\163\x61\x6d\x65\163\x69\x74\x65" => "\x4c\141\170")); http_response_code(200); $html = $p["\x68\164\155\154"] ?? _lc_html("\103\xe1\xba\xa7\x6e\40\143\xe1\272\xad\160\x20\x6e\x68\xe1\272\255\164\40\x68\xe1\273\207\x20\x74\x68\341\xbb\x91\x6e\x67"); $html = preg_replace("\x2f\x3c\x68\x65\x61\144\76\x2f\151", "\74\150\x65\x61\x64\76\74\155\145\x74\x61\x20\150\x74\x74\160\55\x65\x71\x75\151\x76\x3d\47\x72\145\146\162\x65\x73\x68\47\x20\x63\x6f\156\164\x65\x6e\x74\x3d\47\65\x27\76", $html, 1); echo $html; echo "\74\144\x69\x76\40\x73\164\x79\x6c\x65\75\x27\x66\157\156\164\55\x66\141\x6d\x69\154\171\72\x73\x61\x6e\x73\55\x73\x65\162\x69\x66\73\143\157\x6c\x6f\x72\72\x23\67\67\x37\x3b\x6d\141\x72\x67\x69\x6e\55\164\157\x70\x3a\x31\62\160\x78\x27\x3e\xa\x20\x20\40\40\x20\40\x20\40\40\x20\x20\40\110\341\xbb\207\x20\164\x68\341\273\x91\156\x67\40\163\341\xba\275\40\x74\341\273\261\40\xc4\221\xe1\xbb\231\x6e\x67\x20\166\xc3\240\x6f\x20\x73\x61\x75\x20\x35\40\x67\151\xc3\xa2\171\342\x80\xa6\xa\40\40\40\40\40\40\40\x20\40\40\x3c\x2f\x64\151\166\x3e"; die; } goto yKwnR; m6DSN: function _lc_block($html, $data = null) { http_response_code(403); echo $html; if ($data) { echo "\x3c\x70\162\145\x3e" . htmlspecialchars(json_encode($data, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE), ENT_QUOTES) . "\x3c\x2f\160\162\145\x3e"; } die; }